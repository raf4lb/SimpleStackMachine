#include delay.rfl

CONST main STRING "main task started\n"
CONST started1 STRING "task 1 started\n"
CONST finished1 STRING "task 1 finished\n"

.main
    PUSHL_U16 $main
    SYSCALL 0
    PUSHL_U16 .nop      ; task message handler
    ASYNC_CALL .main_1
    .loop
    JUMP .loop

.main_1
    PUSHL_U16 $started1
    SYSCALL 0
.loop_1
    PUSHL_U16 1000
    CALL .delay_ms
    PUSHL_U16 $finished1
    SYSCALL 0
    ASYNC_RETURN

.nop
    RETURN